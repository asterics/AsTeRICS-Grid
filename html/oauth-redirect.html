<!DOCTYPE html>
<html lang="en" class="notranslate" translate="no">
<head>
    <title>AsTeRICS Grid - OAuth redirect page</title>
</head>
<body>

<script type="module">
    import {constants} from '../src/js/util/constants.js';

    let currentLoginId = window.localStorage.getItem(constants.OAUTH_CURRENT_LOGIN_ID_KEY);
    //window.localStorage.removeItem(constants.OAUTH_CURRENT_LOGIN_ID_KEY);

    for (let config of constants.OAUTH_CONFIGS) {
        if (config.id === currentLoginId) {
            let key = constants.OAUTH_RETURNED_PARAMS_MAP;
            let map = localStorage.getItem(key);
            map = map ? JSON.parse(map) : {};
            map[config.id] = window.location.search;
            window.localStorage.setItem(key, JSON.stringify(map));
            location.replace(location.origin);
        }
    }
    console.warn("Oauth response could not be processed!", currentLoginId, constants.OAUTH_CONFIGS, window.location.search);
</script>
</body>
</html>